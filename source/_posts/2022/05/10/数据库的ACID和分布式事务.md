---
title: 数据库的ACID和分布式事务  
date: 2022-05-10 20:00:00  
tags: 
	- 数据库
categories: 
	- 数据库
---

前面写了一篇关于`CAP原理`的博文，说到`一致性 Consistency`，有人往往会想到事务`ACID`特性中的`C: Consistency`，虽然都叫一致性，但完全是两个东西。  

- `CAP`的一致性指：数据库的同一复制集（replicaSet）之间数据相同。  
	_这里的“数据库”，可以是主从、主备、集群架构，但没有单机架构。_
- `ACID`的一致性指：在数据库单一实例中(暂不涉及多个数据源的分布式事务)，成功写入的数据不违反已定义的数据规则，如约束、级联规则等等。    
接着，来通过本地事务的详细说一下`ACID`，以及跨多数据源的分布式事务。  
<!-- more -->

### 1. 本地事务ACID
`本地事务`，这里指单个业务服务仅操作单一数据源，完全由 DBMS 提供的事务能力。
除去上面对`Consistency`的解释外，剩下的三项：  

- `Atomic(原子性)`：在事务边界内的所有写操作，要么一起成功，要么一起失败(也叫 All-or-Nothing）。  
阻止出现只有部分更新的数据异常。  
- `Isolation(隔离性)`：存在并发的情况下，不同的连接的读、写操作相互之间独立，尽量不受影响。  
从低到高分为四个隔离级别：`Read uncommitted`、`Read committed`、`Repeatable read`、`Serializable`。各数据库厂商实现方式不同，造成标准的表现性有些许差别。比如 MySQL InnoDB采用 MVCC 机制实现事务隔离，Repeatable read 级别可以防止幻读。
- `Durability(持久性)`：保证所有成功提交的数据都能正确被持久化，不会被丢失。

### 跨多数据源的分布式事务

__（未完待续）__

