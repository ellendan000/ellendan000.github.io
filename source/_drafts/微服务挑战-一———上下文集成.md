---
title: 微服务挑战(一)——上下文集成
categorys:
    - 分布式架构
tags:
    - 分布式架构
    - 微服务治理
---

众所周知，微服务架构并不只是简单的开发问题。
微服务架构，涉及到软件开发流程中的`微服务拆分和定义（产品规划）`、`微服务开发`、`微服务构建与部署`、`监控与运维`四个阶段，
相比于传统的单体服务，分别给产品架构、开发技术、DevOps技术、全链路可视化等方面带来了额外挑战。

今天，秉持先易后难的原则，先从`微服务开发`这个角度聊一聊 —— 微服务架构带来哪些挑战。
`挑战一：上下文集成`,也可以叫`微服务集成`。
备注：`上下文集成`名词来自DDD。

### 1. 上下文集成，需要解决哪些问题？
相比于微服务架构，原传统的单体架构并没有这些集成问题，主要表现：
1. 与一个用户请求相关的任务——都在一条线程中完成
2. 与数据一致性相关的问题，都由一个数据库ACID事务解决
3. 在同一个事务内，不需要特别仔细地区分业务上下游调用关系

因此，当单体应用被拆分为微服务架构之后，带来了集成的问题，需要考虑：
1. 使用哪种集成方式和协议？RPC、消息中间件、分布式事务、分布式调度服务？
2. 如何正确的传递结果和异常处理 
3. 如何保证业务流程上数据的一致性
4. 如何设计和实现服务的上下游关系，避免链路的循环依赖和调用

### 2. 上下文集成，可用方案
从技术选型的角度，上下文集成的可用方案，基本可以分为四大类：
`RPC`、`消息中间件`、`分布式事务`、`分布式调度服务`。
但是，这四种技术方案，为了解决上下文集成面临的问题，需要进行各自详细的方案完善和设计，同时也不可避免的带来另外的风险和问题。

#### 2.1 RPC 远程调用
经常会有面试官问：RPC 和 RMI 的区别？
